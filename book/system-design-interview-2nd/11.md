---
description: 대규모 시스템 설계 기초 2nd 11장을 요약한 내용입니다.
---

"결제 시스템"은 금전적 가치의 이전을 통해 금융 거래를 정산하는 데 사용되는 모든 시스템

여기에는 가치 교환을 가능하게 하는 제도, 도구, 사람, 규칙 절차, 표준 및 기술이 포함

# 1단계: 문제 이해 및 설계 범위 확정

## 기능 요구사항

대금 수신(pay-in) 흐름:
- 결제 시스템이 판매자를 대신하여 고객으로부터 대금을 수령
  
대금 정산(pay-out) 흐름:
- 결제 시스템이 전 세계의 판매자에게 제품 판매 대금을 송금

## 비기능 요구사항

신뢰성 및 내결함성:
- 결제 실패는 신중하게 처리해야 한다.

내부 서비스(결제/회계 시스템)와 외부 서비스(결제 서비스 제공업체) 간의 조정 프로세스:
- 시스템 간의 결제 정보가 일치하는지 비동기적으로 확인

## 개략적인 규모 추정

하루에 100만 건의 트랜잭션을 처리해야 하는데, 
- 이는 1,000,000 건의 트랜잭션 / 10^5초 = 초당 10건의 트랜잭션(TPS)
- 10TPS는 일반적인 데이터베이스로 별 문제 없이 처리 가능한 양이므로, 처리 대역폭 대신 결제 트랜잭션의 정확한 처리에 초점

# 2단계: 개략적 설계안 제시 및 동의 구하기

결제 흐름은 자금의 흐름을 반영하기 위해 크게 두 단계로 세분화
- **대금 수신 흐름**: 구매자가 주문을 하면 아마존의 은행 계좌로 돈이 들어오는 것
- **대금 정산 흐름**: 제품이 배송되면, 계좌에 묶여 있던 판매 대금에서 수수료를 제외한 잔액이 판매자의 은행 계좌로 지급

<figure><img src="../../.gitbook/assets/system-design-interview-2nd/11.1.png" alt=""><figcaption></figcaption></figure>

## 대금 수신 흐름

### 결제 서비스

결제 이벤트를 수락하고 결제 프로세스를 조율
- `AML/CFT`와 같은 규정을 준수하는지, 자금 세탁이나 테러 자금 조달과 같은 범죄 행위의 증거가 있는지 평가하는 위험 점검을 일반적으로 먼저 수행
  - 자금세탁방지(AML·Anti-Money Laundering)
  - 테러자금조달방지(CFT·Combating the Financing of Terrorism)
- 위험 확인 서비스는 복잡하고 전문화되어 있으므로 제3자 제공업체를 주로 이용

<figure><img src="../../.gitbook/assets/system-design-interview-2nd/11.2.png" alt=""><figcaption></figcaption></figure>



# 3단계: 사엣 설계

# 4단계: 마무리

# 요약
