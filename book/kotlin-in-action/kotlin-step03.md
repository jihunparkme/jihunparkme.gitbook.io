# μ½”ν‹€λ¦° Step03 - μ λ„¤λ¦­μ¤, μ• λ…Έν…μ΄μ…, λ¦¬ν”λ ‰μ…

<details>
<summary>π“’Β μ λ„¤λ¦­μ¤ μ”μ•½</summary>

- μ λ„¤λ¦­ ν•¨μμ™€ ν΄λμ¤λ¥Ό μλ°”μ™€ λΉ„μ·ν•κ² μ„ μ–Έ

```kotlin
fun <T> identity(value: T): T {
    return value
}

class Box<T>(val value: T)

@Test
fun `μ λ„¤λ¦­ ν•¨μ`() {
    assertEquals(42, identity(42))
    assertEquals("Hello", identity("Hello"))
}

@Test
fun `μ λ„¤λ¦­ ν΄λμ¤`() {
    val intBox = Box(42)
    val stringBox = Box("Hello")

    assertEquals(42, intBox.value)
    assertEquals("Hello", stringBox.value)
}
```

- μλ°”μ™€ λ§μ°¬κ°€μ§€λ΅ μ λ„¤λ¦­ νƒ€μ…μ νƒ€μ… μΈμλ” μ»΄νμΌ μ‹μ μ—λ§ μ΅΄μ¬
- νƒ€μ… μΈμκ°€ μ‹¤ν–‰ μ‹μ μ— μ§€μ›μ§€λ―€λ΅ νƒ€μ… μΈμκ°€ μλ” νƒ€μ…(μ λ„¤λ¦­ νƒ€μ…)μ„ is μ—°μ‚°μλ¥Ό μ‚¬μ©ν•΄ κ²€μ‚¬ λ¶κ°€
- μΈλΌμΈ ν•¨μμ νƒ€μ… λ§¤κ°λ³€μλ¥Ό `refied`λ΅ ν‘μ‹ν•΄μ„ μ‹¤μ²΄ν™”ν•λ©΄ μ‹¤ν–‰ μ‹μ μ— κ·Έ νƒ€μ…μ„ isλ΅ κ²€μ‚¬ν•κ±°λ‚ java.lang.Class μΈμ¤ν„΄μ¤λ¥Ό μ–»μ„ μ μλ‹¤.
- λ³€μ„±μ€ κΈ°μ € ν΄λμ¤κ°€ κ°™κ³  νƒ€μ… νλΌλ―Έν„°κ°€ λ‹¤λ¥Έ λ‘ μ λ„¤λ¦­ νƒ€μ… μ‚¬μ΄μ μƒμ„/ν•μ„ νƒ€μ… κ΄€κ³„κ°€ νƒ€μ… μΈμ μ‚¬μ΄μ μƒμ„/ν•μ„ νƒ€μ… κ΄€κ³„μ— μν•΄ μ–΄λ–¤ μν–¥μ„ λ°›λ”μ§€λ¥Ό λ…μ‹ν•λ” λ°©λ²•

```kotlin
open class Animal
class Dog : Animal()
class Box<out T>(val value: T)

@Test
fun `λ³€μ„± ν…μ¤νΈ`() {
    val dogBox: Box<Dog> = Box(Dog())
    val animalBox: Box<Animal> = dogBox // out ν‚¤μ›λ“λ΅ μΊμ¤ν… κ°€λ¥

    assertTrue(animalBox is Box<Animal>)
}
```

- μ λ„¤λ¦­ ν΄λμ¤μ νƒ€μ… νλΌλ―Έν„°κ°€ `out` μ„μΉμ—μ„λ§ μ‚¬μ©λλ” κ²½μ°(μƒμ‚°μ) κ·Έ νƒ€μ… νλΌλ―Έν„°λ¥Ό `out`μΌλ΅ ν‘μ‹ν•΄μ„ κ³µλ³€μ μΌλ΅ λ§λ“¤ μ μλ‹¤.
    - μ½”ν‹€λ¦°μ μ½κΈ° μ „μ© List μΈν„°νμ΄μ¤λ” κ³µλ³€μ μ΄λ‹¤.
    - λ”°λΌμ„ List<String>μ€ List<Any)μ ν•μ„ νƒ€μ…μ΄λ‹¤.
- κ³µλ³€μ μΈ κ²½μ°μ™€ λ°λ€λ΅ μ λ„¤λ¦­ ν΄λμ¤μ νƒ€μ… νλΌλ―Έν„°κ°€ `in` μ„μΉμ—μ„λ§ μ‚¬μ©λλ” κ²½μ°(μ†λΉ„μ) κ·Έ νƒ€μ… νλΌλ―Έν„°λ¥Ό `in`μΌλ΅ ν‘μ‹ν•΄μ„ λ°κ³µλ³€μ μΌλ΅ λ§λ“¤ μ μλ‹¤.
- ν•¨μ μΈν„°νμ΄μ¤λ” μ²« λ²μ§Έ νƒ€μ… νλΌλ―Έν„°μ— λ€ν•΄μ„λ” λ°κ³µλ³€μ μ΄κ³ , λ‘ λ²μ§Έ νƒ€μ… νλΌλ―Έν„°μ— λ€ν•΄μ„λ” κ³µλ³€μ μ΄λ‹¤.
    - κ·Έλμ„ (Animal) β†’ Intλ” (Cat) β†’ Numberμ ν•μ„ νƒ€μ…μ΄λ‹¤.
- μ½”ν‹€λ¦°μ—μ„λ” μ λ„¤λ¦­ ν΄λμ¤μ κ³µλ³€μ„±μ„ μ „μ²΄μ μΌλ΅ μ§€μ •ν•κ±°λ‚(μ„ μ–Έ μ§€μ  λ³€μ„±) κµ¬μ²΄μ μΈ μ‚¬μ© μ„μΉμ—μ„ μ§€μ •ν•  μ μλ‹¤. (μ‚¬μ© μ§€μ  λ³€μ„±)
- μ λ„¤λ¦­ ν΄λμ¤μ νƒ€μ… μΈμκ°€ μ–΄λ–¤ νƒ€μ…μΈμ§€ μ •λ³΄κ°€ μ—†κ±°λ‚ νƒ€μ… μΈμκ°€ μ–΄λ–¤ νƒ€μ…μΈμ§€κ°€ μ¤‘μ”ν•μ§€ μ•μ„ λ• μ¤νƒ€ ν”„λ΅μ μ…(`*`) κµ¬λ¬Έμ„ μ‚¬μ©ν•  μ μλ‹¤.
</details>

<details>
<summary>π“•Β μ• λ…Έν…μ΄μ…κ³Ό λ¦¬ν”λ ‰μ… μ”μ•½</summary>

- μ½”ν‹€λ¦°μ—μ„ μ• λ…Έν…μ΄μ…μ„ μ μ©ν•  λ• μ‚¬μ©ν•λ” λ¬Έλ²•μ€ μλ°”μ™€ κ±°μ λ™μΌ
- μ½”ν‹€λ¦°μ—μ„λ” μλ°”λ³΄λ‹¤ λ” λ„“μ€ λ€μƒμ— μ• λ…Έν…μ΄μ…μ„ μ μ© κ°€λ¥ (ex. νμΌκ³Ό μ‹(expression))
- μ• λ…Έν…μ΄μ… μΈμλ΅ μ›μ‹ νƒ€μ… κ°’, λ¬Έμμ—΄, μ΄λ„, ν΄λμ¤ μ°Έμ΅°, λ‹¤λ¥Έ μ• λ…Έν…μ΄μ… ν΄λμ¤μ μΈμ¤ν„΄μ¤, κ·Έλ¦¬κ³  μ§€κΈκΉμ§€ λ§ν• μ—¬λ¬ μ ν•μ κ°’μΌλ΅ μ΄λ¤„μ§„ λ°°μ—΄μ„ μ‚¬μ© κ°€λ¥
- `@get:Rule`μ„ μ‚¬μ©ν•΄ μ• λ…Έν…μ΄μ…μ μ‚¬μ© λ€μƒμ„ λ…μ‹ν•λ©΄ ν• μ½”ν‹€λ¦° μ„ μ–Έμ΄ μ—¬λ¬ κ°€μ§€ λ°”μ΄νΈ μ½”λ“ μ”μ†λ¥Ό λ§λ“¤μ–΄λ‚΄λ” κ²½μ° μ •ν™•ν μ–΄λ–¤ λ¶€λ¶„μ— μ• λ…Έν…μ΄μ…μ„ μ μ©ν• μ§€ μ§€μ • κ°€λ¥
- μ• λ…Έν…μ΄μ… ν΄λμ¤λ¥Ό μ •μν•  λ•λ” λ³Έλ¬Έμ΄ μ—†κ³  μ£Ό μƒμ„±μμ λ¨λ“  νλΌλ―Έν„°λ¥Ό val ν”„λ΅νΌν‹°λ΅ ν‘μ‹ν• μ½”ν‹€λ¦° ν΄λμ¤λ¥Ό μ‚¬μ©

```kotlin
@Target(AnnotationTarget.CLASS, AnnotationTarget.FUNCTION)
@Retention(AnnotationRetention.RUNTIME)
annotation class MyAnnotation(val name: String, val value: Int)
```

- λ©”νƒ€μ• λ…Έν…μ΄μ…μ„ μ‚¬μ©ν•΄ λ€μƒ, μ• λ…Έν…μ΄μ… μ μ§€ λ°©μ‹ λ“± μ—¬λ¬ μ• λ…Έν…μ΄μ… νΉμ„±μ„ μ§€μ • κ°€λ¥

```kotlin
@Target(AnnotationTarget.CLASS, AnnotationTarget.FUNCTION) // μ• λ…Έν…μ΄μ… μ μ© λ€μƒ
@Retention(AnnotationRetention.RUNTIME) // μ• λ…Έν…μ΄μ… μ μ§€ λ°©μ‹
@MustBeDocumented // λ¬Έμ„ν™” μ—¬λ¶€
annotation class MyAnnotation(val name: String, val value: Int)
```

- λ¦¬ν”λ ‰μ… APIλ¥Ό ν†µν•΄ μ‹¤ν–‰ μ‹μ μ— κ°μ²΄μ λ©”μ†λ“μ™€ ν”„λ΅νΌν‹°λ¥Ό μ—΄κ±°ν•κ³  μ ‘κ·Ό κ°€λ¥
    - λ¦¬ν”λ ‰μ… APIμ—λ” ν΄λμ¤(KClass), ν•¨μ(KFunction) λ“± μ—¬λ¬ μΆ…λ¥μ μ„ μ–Έμ„ ν‘ν„ν•λ” μΈν„°νμ΄μ¤ μ κ³µ
- ν΄λμ¤λ¥Ό μ»΄νμΌ μ‹μ μ— μ•κ³  μλ‹¤λ©΄ `KClass` μΈμ¤ν„΄μ¤λ¥Ό μ–»κΈ° μ„ν•΄ ClassName::classλ¥Ό μ‚¬μ©
    - ν•μ§€λ§ μ‹¤ν–‰ μ‹μ μ— obj λ³€μμ— λ‹΄κΈ΄ κ°μ²΄λ΅λ¶€ν„° KClass μΈμ¤ν„΄μ¤λ¥Ό μ–»κΈ° μ„ν•΄μ„λ” obj.javaClass.kotlinμ„ μ‚¬μ©
- `KFunction`κ³Ό `KProperty` μΈν„°νμ΄μ¤λ” λ¨λ‘ KCallableμ„ ν™•μ¥
    - KClassableμ€ μ λ„¤λ¦­ call λ©”μ†λ“λ¥Ό μ κ³µ
- `KCallable.callBy` λ©”μ†λ“λ¥Ό μ‚¬μ©ν•λ©΄ λ©”μ†λ“λ¥Ό νΈμ¶ν•λ©΄μ„ λ””ν΄νΈ νλΌλ―Έν„°κ°’μ„ μ‚¬μ© κ°€λ¥
- `KFunction0`, `KFunctiuon1` λ“±μ μΈν„°νμ΄μ¤λ” λ¨λ‘ νλΌλ―Έν„° μκ°€ λ‹¤λ¥Έ ν•¨μλ¥Ό ν‘ν„ν•λ©°, invoke λ©”μ†λ“λ¥Ό μ‚¬μ©ν•΄ ν•¨μ νΈμ¶ κ°€λ¥
- `KProperty0`λ” μµμƒμ„ ν”„λ΅νΌν‹°λ‚ λ³€μ, `KProperty1`μ€ μμ‹  κ°μ²΄κ°€ μλ” ν”„λ΅νΌν‹°μ— μ ‘κ·Όν•  λ• μ“°λ” μΈν„°νμ΄μ¤
    - λ‘ μΈνΌν…μ΄μ¤ λ¨λ‘ GET λ©”μ†λ“λ¥Ό μ‚¬μ©ν•΄ ν”„λ΅νΌν‹° κ°’μ„ κ°€μ Έμ¬ μ μμ
    - `KMutableProperty0`κ³Ό `KMutableProperty1`μ€ κ°κ° KProperty0κ³Ό KProperty1μ„ ν™•μ¥ν•λ©°, set λ©”μ†λ“λ¥Ό ν†µν•΄ ν”„λ΅νΌν‹°κ°’μ„ λ³€κ²½ν•  μ μκ² μ§€μ›
</details>

---

# **μ λ„¤λ¦­ νƒ€μ… νλΌλ―Έν„°**

## **μ λ„¤λ¦­ ν•¨μμ™€ ν”„λ΅νΌν‹°**

> μ–΄λ–¤ νΉμ • νƒ€μ…μ„ μ €μ¥ν•λ” λ¦¬μ¤νΈ λΏ μ•„λ‹λΌ, λ¨λ“  λ¦¬μ¤νΈλ¥Ό λ‹¤λ£° μ μλ” ν•¨μλ¥Ό μ›ν•  λ• μ λ„¤λ¦­ ν•¨μλ¥Ό μ‘μ„±

<center><img src="../../.gitbook/assets/kotlin/generic.png" width="50%"></center>

https://livebook.manning.com/book/kotlin-in-action/chapter-9/17

μ΄λ° ν•¨μλ¥Ό κµ¬μ²΄μ μΈ λ¦¬μ¤νΈμ— λ€ν•΄ νΈμ¶ν•  λ• νƒ€μ… μΈμλ¥Ό λ…μ‹μ μΌλ΅ μ§€μ •ν•  μ μμ§€λ§ μ‹¤μ λ΅λ” λ€λ¶€λ¶„ μ»΄νμΌλ¬κ°€ νƒ€μ… μΈμλ¥Ό μ¶”λ΅ ν•  μ μμΌλ―€λ΅ κ·Έλ΄ ν•„μ”κ°€ μ—†λ‹¤.

```kotlin
@Test
fun `μ λ„¤λ¦­ ν•¨μ`() {
    val letters = ('a'..'z').toList()
    assertEquals(listOf('a', 'b', 'c'),  letters.slice<Char>(0..2)) // νƒ€μ… μΈμλ¥Ό λ…μ‹μ μΌλ΅ μ§€μ •
    assertEquals(listOf('k', 'l', 'm', 'n'),  letters.slice(10..13)) // μ»΄νμΌλ¬λ” Tκ°€ CharλΌλ” μ‚¬μ‹¤μ„ μ¶”λ΅ 
}
```

---

## **νƒ€μ… νλΌλ―Έν„° μ μ•½**

> μ–΄λ–¤ νƒ€μ…μ„ μ λ„¤λ¦­ νƒ€μ…μ νƒ€μ… νλΌλ―Έν„°μ— λ€ν• μƒν•(upper bound)μΌλ΅ μ§€μ •ν•λ©΄ 
> 
> κ·Έ μ λ„¤λ¦­ νƒ€μ…μ„ μΈμ¤ν„΄μ¤ν™”ν•  λ• μ‚¬μ©ν•λ” νƒ€μ… μΈμλ” λ°λ“μ‹ κ·Έ μƒν• νƒ€μ…μ΄κ±°λ‚,
> 
> κ·Έ μƒν• νƒ€μ…μ ν•μ„ νƒ€μ…μ΄μ–΄μ•Ό ν•λ‹¤.

<center><img src="../../.gitbook/assets/kotlin/type-parameter.png" width="50%"></center>

https://livebook.manning.com/book/kotlin-in-action/chapter-9/17

νƒ€μ… νλΌλ―Έν„° `T`μ— λ€ν• μƒν•μ„ μ •ν•κ³  λ‚λ©΄ `T νƒ€μ…`μ κ°’μ„ κ·Έ μƒν• νƒ€μ…μ κ°’μΌλ΅ μ·¨κΈ‰ κ°€λ¥

```kotlin
@Test
fun `νƒ€μ… νλΌλ―Έν„° μ μ•½`() {
    fun <T : Number> oneHalf(value: T): Double { // Numberλ¥Ό νƒ€μ… νλΌλ―Έν„° μƒν•μΌλ΅ μ§€μ •
        return value.toDouble() / 2.0 // Number ν΄λμ¤μ— μ •μλ λ©”μ†λ“λ¥Ό νΈμ¶
    }

    assertEquals(1.5, oneHalf(3))
}
```

---

## **νƒ€μ… νλΌλ―Έν„°λ¥Ό λ„μ΄ λ  μ μ—†λ” νƒ€μ…μΌλ΅ ν•μ •**

μ•„λ¬΄λ° μƒν•μ„ μ •ν•μ§€ μ•μ€ νƒ€μ… νλΌλ―Έν„°λ” κ²°κ³Όμ μΌλ΅ `Any?`λ¥Ό μƒν•μΌλ΅ μ •ν• νλΌλ―Έν„°μ™€ λ™μΌ

```kotlin
class Processor<T> {
		fun process(value: T) {
				value?.hashCode() // μ•μ „ν• νΈμ¶ ν•„μ”
		}
}
```

`<T : Any>`λΌλ” μ μ•½μ€ `T νƒ€μ…`μ΄ ν•­μƒ λ„μ΄ λ  μ μ—†λ” νƒ€μ…μ΄ λλ„λ΅ λ³΄μ¥

```kotlin
class Processor<T : Any> {
		fun process(value: T) {
				value.hashCode()
		}
}
```

# **μ‹¤ν–‰ μ‹ μ λ„¤λ¦­μ¤μ λ™μ‘**

## **μ‹¤ν–‰ μ‹μ μ μ λ„¤λ¦­: νƒ€μ… κ²€μ‚¬μ™€ μΊμ¤νΈ**

> μλ°”μ™€ λ§μ°¬κ°€μ§€λ΅ μ½”ν‹€λ¦° μ λ„¤λ¦­ νƒ€μ… μΈμ μ •λ³΄λ” λ°νƒ€μ„μ— μ§€μ›μ§„λ‹¤. 
> 
> μ΄λ” μ λ„¤λ¦­ ν΄λμ¤ μΈμ¤ν„΄μ¤κ°€ κ·Έ μΈμ¤ν„΄μ¤λ¥Ό μƒμ„±ν•  λ• μ“°μΈ νƒ€μ… μΈμμ— λ€ν• μ •λ³΄λ¥Ό μ μ§€ν•μ§€ μ•λ”λ‹¤λ” μλ―Έ

```kotlin
val list1: List<String> = listOf("a", "b")
val list2: List<Int> = listOf(1, 2, 3)
```

<center><img src="../../.gitbook/assets/kotlin/type.png" width="50%"></center>

https://livebook.manning.com/book/kotlin-in-action/chapter-9/17

μ»΄νμΌλ¬λ” λ‘ λ¦¬μ¤νΈλ¥Ό μ„λ΅ λ‹¤λ¥Έ νƒ€μ…μΌλ΅ μΈμ‹ν•μ§€λ§ μ‹¤ν–‰ μ‹μ μ— κ·Έ λ‘μ€ μ™„μ „ν κ°™μ€ νƒ€μ…μ κ°μ²΄

- νƒ€μ… νλΌλ―Έν„°κ°€ 2κ° μ΄μƒμ΄λΌλ©΄ λ¨λ“  νƒ€μ… νλΌλ―Έν„°μ— `*`λ¥Ό ν¬ν•¨

```kotlin
@Test
fun `μ‹¤ν–‰ μ‹μ μ μ λ„¤λ¦­`() {
    fun printSum(c: Collection<*>): Int {
        val intList = c as? List<Int>
            ?: throw IllegalArgumentException("List is expected")
        return intList.sum()
    }

    val actual = listOf(1, 2, 3)
    assertEquals(6, printSum(actual))
    
    // μ‹¤ν–‰ μ‹μ μ—λ” μ λ„¤λ¦­ νƒ€μ…μ νƒ€μ… μΈμλ¥Ό μ• μ μ—†μΌλ―€λ΅ μΊμ¤ν…μ€ ν•­μƒ μ„±κ³µ
    assertThrows<IllegalArgumentException> {
        printSum(setOf(1, 2, 3))
    }
    // μλ»λ νƒ€μ…μ μ›μ†κ°€ λ“¤μ–΄μλ” λ¦¬μ¤νΈλ¥Ό μ „λ‹¬ν•λ©΄ μ‹¤ν–‰ μ‹μ μ— ClassCaseException λ°μƒ
    assertThrows<ClassCastException> {
        printSum(listOf('a', 'b', 'c'))
    }
}
```

μ½”ν‹€λ¦° μ»΄νμΌλ¬λ” μ»΄νμΌ μ‹μ μ— νƒ€μ… μ •λ³΄κ°€ μ£Όμ–΄μ§„ κ²½μ°μ—λ” is κ²€μ‚¬λ¥Ό μν–‰ν•κ² ν—μ©

```kotlin
fun printSum(c: Collection<Int>): Int {
    if (c is List<Int>) {
        return c.sum()
    }
    throw IllegalArgumentException("is not list")
}

assertEquals(6, printSum(listOf(1, 2, 3)))
assertThrows<IllegalArgumentException> {
    printSum(setOf(1, 2, 3))
}
```

## **μ‹¤μ²΄ν™”ν• νƒ€μ… νλΌλ―Έν„°μ μ μ•½**

μ•„λμ κ²½μ° μ‹¤μ²΄ν™”ν• νƒ€μ… νλΌλ―Έν„° μ‚¬μ© κ°€λ¥

- νƒ€μ… κ²€μ‚¬μ™€ μΊμ¤ν…(is, !is, as, as?)
- μ½”ν‹€λ¦° λ¦¬ν”λ ‰μ… API(::class) β†’ 10μ¥μ—μ„ μ„¤λ…
- μ½”ν‹€λ¦° νƒ€μ…μ— λ€μ‘ν•λ” java.lang.Classλ¥Ό μ–»κΈ°(::class.java)
- λ‹¤λ¥Έ ν•¨μλ¥Ό νΈμ¶ν•  λ• νƒ€μ… μΈμλ΅ μ‚¬μ©

ν•μ§€λ§ μ•„λμ™€ κ°™μ€ μΌμ€ ν•  μ μ—†μ

- νƒ€μ… νλΌλ―Έν„° ν΄λμ¤μ μΈμ¤ν„΄μ¤ μƒμ„±ν•κΈ°
- νƒ€μ… νλΌλ―Έν„° ν΄λμ¤μ λ™λ° κ°μ²΄ λ©”μ†λ“ νΈμ¶ν•κΈ°
- μ‹¤μ²΄ν™”ν• νƒ€μ… νλΌλ―Έν„°λ¥Ό μ”κµ¬ν•λ” ν•¨μλ¥Ό νΈμ¶ν•λ©΄μ„ μ‹¤μ²΄ν™”ν•μ§€ μ•μ€ νƒ€μ… νλΌλ―Έν„°λ΅ λ°›μ€ νƒ€μ…μ„ νƒ€μ… μΈμλ΅ λ„κΈ°κΈ°
- ν΄λμ¤, ν”„λ΅νΌν‹°, μΈλΌμΈ ν•¨μκ°€ μ•„λ‹ ν•¨μμ νƒ€μ… νλΌλ―Έν„°λ¥Ό refiedλ΅ μ§€μ •ν•κΈ°

# **λ³€μ„±: μ λ„¤λ¦­κ³Ό ν•μ„ νƒ€μ…**

> `List<String>`μ™€ `List<Any>`μ™€ κ°™μ΄ κΈ°μ € νƒ€μ…μ΄ κ°™κ³  νƒ€μ… μΈμκ°€ λ‹¤λ¥Έ μ—¬λ¬ νƒ€μ…μ΄ 
> 
> μ„λ΅ μ–΄λ–¤ κ΄€κ³„κ°€ μλ”μ§€ μ„¤λ…ν•λ” κ°λ…

β…Β λ³€μ„±μ„ μ ν™μ©ν•λ©΄ μ‚¬μ©μ— λ¶νΈν•μ§€ μ•μΌλ©΄μ„ νƒ€μ… μ•μ „μ„±μ„ λ³΄μ¥ν•λ” APIλ¥Ό λ§λ“¤ μ μλ‹¤.

## **λ³€μ„±μ΄ μλ” μ΄μ : μΈμλ¥Ό ν•¨μμ— λ„κΈ°κΈ°**

`List<Any>` νƒ€μ…μ νλΌλ―Έν„°λ¥Ό λ°›λ” ν•¨μμ— `List<String>`μ„ λ„κΈ°λ©΄ μ•μ „ν• κΉβ“

- String ν΄λμ¤λ” Anyλ¥Ό ν™•μ¥ν•λ―€λ΅, Any νƒ€μ… κ°’μ„ νλΌλ―Έν„°λ΅ λ°›λ” ν•¨μμ— String κ°’μ„ λ„κ²¨λ„ μ•μ „
- ν•μ§€λ§ Anyμ™€ Stringμ΄ List μΈν„°νμ΄μ¤μ νƒ€μ… μΈμλ΅ λ“¤μ–΄κ°€λ” κ²½μ° μμ‹  μκ² μ•μ „μ„±μ„ λ§ν•  μ μ—†μ

```kotlin
val strings = mutableListOf(1, 2.0, "abc", "bac")
strings.add("asbc")
println(strings.maxBy { it.length }) // Type mismatch μ—λ¬
```

---

## **κ³µλ³€μ„±: ν•μ„ νƒ€μ… κ΄€κ³„λ¥Ό μ μ§€**

Aκ°€ Bμ ν•μ„ νƒ€μ…μΌ λ• Producer<A>κ°€ Producer<B>μ ν•μ„ νƒ€μ…μ΄λ©΄ Peoducerλ” κ³µλ³€μ 

- μ΄λ¥Ό ν•μ„ νƒ€μ… κ΄€κ³„κ°€ μ μ§€λλ‹¤κ³  μ„¤λ…
- μλ¥Ό λ“¤μ–΄ Catκ°€ Animalμ ν•μ„ νƒ€μ…μ΄κΈ° λ•λ¬Έμ— Producer<Cat>μ€ Producer<Animal>μ ν•μ„ νƒ€μ…

μ½”ν‹€λ¦°μ—μ„ μ λ„¤λ¦­ ν΄λμ¤κ°€ νƒ€μ… νλΌλ―Έν„°μ— λ€ν•΄ κ³µλ³€μ μ„μ„ ν‘μ‹ν•λ ¤λ©΄ νƒ€μ… νλΌλ―Έν„° μ΄λ¦„ μ•μ— `out`μ„ λ…μ‹

```kotlin
interface Producer<out T> {  // ν΄λμ¤κ°€ Tμ— λ€ν•΄ κ³µλ³€μ μ΄λΌκ³  μ„ μ–Έ
    fun produce(): T
}
```

ν΄λμ¤μ νƒ€μ… νλΌλ―Έν„°λ¥Ό κ³µλ³€μ μΌλ΅ λ§λ“¤λ©΄ ν•¨μ μ •μμ— μ‚¬μ©ν• νλΌλ―Έν„° νƒ€μ…κ³Ό νƒ€μ… μΈμμ νƒ€μ…μ΄ μ •ν™•ν μΌμΉν•μ§€ μ•λ”λΌλ„ κ·Έ ν΄λμ¤μ μΈμ¤ν„΄μ¤λ¥Ό ν•¨μ μΈμλ‚ λ°ν™κ°’μΌλ΅ μ‚¬μ©ν•  μ μλ‹¤.

```kotlin
open class Animal {
    fun feed() { ... }
}
// T νƒ€μ… νλΌλ―Έν„°μ— λ€ν•΄ μ•„λ¬΄ λ³€μ„±λ„ μ§€μ •ν•μ§€ μ•μ•κΈ° λ•λ¬Έμ—(λ¬΄κ³µλ³€μ„±)
// κ³ μ–‘μ΄ λ¬΄λ¦¬λ” λ™λ¬Ό λ¬΄λ¦¬μ ν•μ„ ν΄λμ¤κ°€ μ•„λ‹λ‹¤.
class Herd<T : Animal> {
    val size: Int get() = ...
    operator fun get(i: Int): T { ... }
}
// κ³ μ–‘μ΄ λ¬΄λ¦¬λ¥Ό λ„κΈ°λ©΄ νƒ€μ… λ¶μΌμΉ(type mismatch) μ¤λ¥ λ°μƒ
fun feedAll(animals: Herd<Animal>) {
    for (i in 0 until animals.size) {
        animals[i].feed()
    }
}

class Cat : Animal() {   
    fun cleanLitter() { ... }
}
fun takeCareOfCats(cats: Herd<Cat>) {
    for (i in 0 until cats.size) {
        cats[i].cleanLitter()
        // feedAll(cats) // type mismatch        
    }
}

---

// TOBE
// Herdλ¥Ό κ³µλ³€μ μΈ ν΄λμ¤λ΅ λ§λ“¤κ³ 
class Herd<out T : Animal> {  
   ...
}
// νΈμ¶ μ½”λ“λ¥Ό μ μ ν λ³€κ²½
fun takeCareOfCats(cats: Herd<Cat>) {
    for (i in 0 until cats.size) {
        cats[i].cleanLitter()
    }
    feedAll(cats)  
}
```

ν΄λμ¤ λ©¤λ²„λ¥Ό μ„ μ–Έν•  λ• νƒ€μ… νλΌλ―Έν„°λ¥Ό μ‚¬μ©ν•  μ μλ” μ§€μ μ€ λ¨λ‘ μΈ(`in`)κ³Ό μ•„μ›ƒ(`out`)μ„μΉλ΅ λ‚λ‰λ‹¤. 

- TλΌλ” νƒ€μ… νλΌλ―Έν„°λ¥Ό μ„ μ–Έν•κ³  Tλ¥Ό μ‚¬μ©ν•λ” ν•¨μκ°€ λ©¤λ²„λ΅ μλ” ν΄λμ¤λ¥Ό μƒκ°ν•΄λ³΄μ.
- Tκ°€ ν•¨μμ `λ°ν™ νƒ€μ…`μ— μ“°μΈλ‹¤λ©΄ Tλ” `μ•„μ›ƒ` μ„μΉ β†’ T νƒ€μ…μ κ°’μ„ μƒμ‚°
- Tκ°€ ν•¨μμ `νλΌλ―Έν„° νƒ€μ…`μ— μ“°μΈλ‹¤λ©΄ Tλ” `μΈ` μ„μΉ β†’ T νƒ€μ…μ κ°’μ„ μ†λΉ„

<center><img src="../../.gitbook/assets/kotlin/position.png" width="50%"></center>


https://livebook.manning.com/book/kotlin-in-action/chapter-9/17