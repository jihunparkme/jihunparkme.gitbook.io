# Part 3. 카프카 스트림즈 관리

# 7장. 모니터링과 성능

## 기본적인 카프카 모니터링

카프카 스트림즈 API는 카프카의 일부이므로 애플리케이션을 모니터링할 때 카프카도 일부 모니터링해야 한다.

[Monitoring](https://kafka.apache.org/documentation/#monitoring)

.

👉🏻 **컨슈머와 프로듀서 성능 측정**
- 프로듀서와 컨슈머의 성능은 처리량과 관련이 있다.
- `프로듀서`의 경우 프로듀서가 얼마나 빠르게 브로커로 메시지를 보내느냐가 큰 관심사
  - 분명 처리량이 높으면 높을수록 더 낮다
- `컨슈머`의 경우 브로커에서 얼마나 빠르게 메시지를 읽을 수 있느냐가 성능에 영향
  - 컨슈머 성능을 측정하는 또 다른 방법은 컨슈머 지연
- 프로듀서가 브로커에 기록하는 속도와 컨슈머가 메시지를 읽는 속도 차이를 `컨슈머 지연`이라고 부른다

.

👉🏻 **컨슈머 지연 확인하기**
- 컨슈머 지연을 확인하기 위해 카프카는 편리한 명령줄 도구를 제공
  - kafka-consumer-groups.sh
- 활성화 상태의 모든 컨슈머 그룹을 찾기 위해 `list` 명령을 사용
  
```bash
kafka-installed-path/bin/kafka-consumer-groups.sh
                --bootstrap-server localhost:9092
                --list
```

- 조회할 컨슈머 그룹 이름을 선택하고 다음 명령을 실행

```bash
kafka-installed-path/bin/kafka-consumer-groups.sh
            --bootstrap-server localhost:9092
            --group GROUP-NAME
            --describe
```

- 작은 지연이나 일정한 지연은 문제가 안 되지만, 시간이 지남에 따라 계속 증가하는 지연은 컨슈머에게 더 많은 리소스를 제공해야 한다

.

👉🏻 **프로듀서와 컨슈머 가로채기**

- `인터셉터`는 디버깅을 위한 일반적인 제일선 도구는 아니지만 카프카 스트리밍 애플리케이션의 동작을 관찰하는 데 유용할 수 있으며, 자신만의 도구 세트에 추가할 만한 유용한 도구이다.
- `인터셉터`를 사용하는 좋은 예제는 카프카 스트림즈 애플리케이션이 카프카 토픽으로 다시 생산하는 메시지 오프셋을 추적하는 데 사용

