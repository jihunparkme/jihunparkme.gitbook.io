# CHAPTER 2. μ½”λ“ μ„¤κ³„

# 3μ¥. μ¬μ‚¬μ©μ„±

## Item 19. knowledgeλ¥Ό λ°λ³µν•μ—¬ μ‚¬μ©ν•μ§€ λ§λΌ

{% hint style="info" %}

**knowledge**: ν”„λ΅μ νΈ μ§„ν–‰ μ‹ μ •μν• λ¨λ“  κ²ƒ

{% endhint %}

ν”„λ΅κ·Έλ¨μ—μ„ μ¤‘μ”ν• `knowledge` λ‘ κ°λ¥Ό λ½‘λ”λ‹¤λ©΄
- λ΅μ§: ν”„λ΅κ·Έλ¨μ΄ μ–΄λ– ν• μ‹μΌλ΅ λ™μ‘ν•λ”μ§€μ™€ μ–΄λ–»κ² λ³΄μ΄λ”μ§€
- κ³µν†µ μ•κ³ λ¦¬μ¦: μ›ν•λ” λ™μ‘μ„ ν•κΈ° μ„ν• μ•κ³ λ¦¬μ¦

.

π‘‰π» **λ¨λ“  κ²ƒμ€ λ³€ν™”ν•λ‹¤**

- λ³€ν™”λ” μ°λ¦¬κ°€ μμƒν•μ§€ λ»ν• κ³³μ—μ„ μΌμ–΄λ‚λ‹¤.
- μ¤λλ‚  λ€λ¶€λ¶„ ν”„λ΅μ νΈλ” λ‡ λ‹¬λ§λ‹¤ μ”κµ¬ μ‚¬ν•­κ³Ό λ‚΄λ¶€μ μΈ κµ¬μ΅°λ¥Ό κ³„μ†ν•΄μ„ λ³€κ²½ν•λ‹¤.
- λ¨λ“  κ²ƒμ€ λ³€ν™”ν•κ³ , μ°λ¦¬λ” μ΄μ— λ€λΉ„ν•΄μ•Ό ν•λ‹¤.

.

π‘‰π» **λ°λ³µν•΄λ„ λλ” μ½”λ“**

- λ‘ μ½”λ“κ°€ κ°™μ€ `knowledge`λ¥Ό λ‚νƒ€λ‚΄λ”μ§€, λ‹¤λ¥Έ `knowledge`λ¥Ό λ‚νƒ€λ‚΄λ”μ§€λ¥Ό 
- "ν•¨κ» λ³€κ²½λ  κ°€λ¥μ„±μ΄ λ†’μ€κ°€? λ”°λ΅ λ³€κ²½λ  κ°€λ¥μ„±μ΄ λ†’μ€κ°€?"λΌλ” μ§λ¬ΈμΌλ΅ μ–΄λ μ •λ„ κ²°μ • κ°€λ¥

.

π‘‰π» **λ‹¨μΌ μ±…μ„ μ›μΉ™**

{% hint style="info" %}

μ½”λ“λ¥Ό μ¶”μ¶ν•΄λ„ λλ”μ§€λ¥Ό ν™•μΈν•  μ μλ” μ›μΉ™μΌλ΅, SOLID μ›μΉ™ μ¤‘ ν•λ‚

{% endhint %}

λ‹¨μΌ μ±…μ„ μ›μΉ™μ€ μ°λ¦¬μ—κ² λ‘ κ°€μ§€ μ‚¬μ‹¤μ„ μ•λ ¤μ¤€λ‹¤.
- μ„λ΅ λ‹¤λ¥Έ κ³³μ—μ„ μ‚¬μ©ν•λ” knowledgeλ” λ…λ¦½μ μΌλ΅ λ³€κ²½ν•  κ°€λ¥μ„±μ΄ λ†’λ‹¤
  - λ”°λΌμ„, λΉ„μ·ν• μ²λ¦¬λ¥Ό ν•λ”λΌλ„ μ™„μ „ν λ‹¤λ¥Έ knowledgeλ΅ μ·¨κΈ‰ν•λ” κ²ƒμ΄ μΆ‹λ‹¤.
- λ‹¤λ¥Έ knowledgeλ” λ¶„λ¦¬ν•΄ λ‘λ” κ²ƒμ΄ μΆ‹λ‹¤.
  - κ·Έλ ‡μ§€ μ•μΌλ©΄, μ¬μ‚¬μ©ν•΄μ„λ” μ• λλ” λ¶€λ¶„μ„ μ¬μ‚¬μ©ν•λ ¤λ” μ νΉμ΄ λ°μƒν•  μ μλ‹¤.

π“– **μ •λ¦¬**

> λ¨λ“  κ²ƒμ€ λ³€ν™”ν•λ‹¤. 
>
> λ”°λΌμ„ κ³µν†µ knowledgeκ°€ μλ‹¤λ©΄, μ΄λ¥Ό μ¶”μ¶ν•΄μ„ λ³€ν™”μ— λ€λΉ„ν•μ.
>
> μ—¬λ¬ μ”μ†μ— λΉ„μ·ν• λ¶€λ¶„μ΄ μλ” κ²½μ°, λ³€κ²½μ΄ ν•„μ”ν•  λ• μ‹¤μκ°€ λ°μƒν•  μ μλ‹¤. μ΄λ° λ¶€λ¶„μ€ μ¶”μ¶ν•λ” κ²ƒμ΄ μΆ‹λ‹¤.
>
> μ¶”κ°€μ μΌλ΅ μλ„ν•μ§€ μ•μ€ μμ •μ„ ν”Όν•λ ¤λ©΄ λλ” λ‹¤λ¥Έ κ³³μ—μ„ μ΅°μ‘ν•λ” λ¶€λ¶„μ΄ μλ‹¤λ©΄, λ¶„λ¦¬ν•΄μ„ μ‚¬μ©ν•μ.

## Item 20. μΌλ°μ μΈ μ•κ³ λ¦¬μ¦μ„ λ°λ³µν•΄μ„ κµ¬ν„ν•μ§€ λ§λΌ

π‘‰π» **ν‘μ¤€ λΌμ΄λΈλ¬λ¦¬ μ‚΄ν΄λ³΄κΈ°**
- μΌλ°μ μΈ μ•κ³ λ¦¬μ¦μ€ λ€λ¶€λ¶„ μ΄λ―Έ λ‹¤λ¥Έ μ‚¬λλ“¤μ΄ μ •μν•΄ λ†“μ•λ‹¤.

.

π‘‰π» **λ‚λ§μ μ ν‹Έλ¦¬ν‹° κµ¬ν„ν•κΈ°**
- ν™•μ¥ ν•¨μμ μ¥μ 
  - ν•¨μλ” μƒνƒλ¥Ό μ μ§€ν•μ§€ μ•μΌλ―€λ΅ ν–‰μ„λ¥Ό λ‚νƒ€λ‚΄κΈ° μΆ‹λ‹¤(νΉν μ‚¬μ΄λ“ μ΄ν™μ΄ μ—†λ” κ²½μ° λ”μ±)
  - ν†±λ λ²¨ ν•¨μμ™€ λΉ„κµν•΄μ„, ν™•μ¥ ν•¨μλ” κµ¬μ²΄μ μΈ νƒ€μ…μ΄ μλ” κ°μ²΄μ—λ§ μ‚¬μ©μ„ μ ν• κ°€λ¥
  - μμ •ν•  κ°μ²΄λ¥Ό μ•„κ·λ¨ΌνΈλ΅ μ „λ‹¬λ°›μ•„ μ‚¬μ©ν•λ” κ²ƒλ³΄λ‹¤ ν™•μ¥ λ¦¬μ‹λ²„λ΅ μ‚¬μ©ν•λ” κ²ƒμ΄ κ°€λ…μ„± μΈ΅λ©΄μ—μ„ μΆ‹μ
  - ν™•μ¥ ν•¨μλ” κ°μ²΄μ— μ •μν• ν•¨μλ³΄λ‹¤ κ°μ²΄ μ‚¬μ© μ‹, μλ™ μ™„μ„± κΈ°λ¥ λ“±μΌλ΅ μ μ•μ΄ μ΄λ£¨μ–΄μ§€λ―€λ΅ μ‰΅κ² μ°Ύμ„ μ μμ

π“– **μ •λ¦¬**

> μΌλ°μ μΈ μ•κ³ λ¦¬μ¦ λ€λ¶€λ¶„ `stdlib`μ— μ΄λ―Έ μ •μλμ–΄ μμ„ κ°€λ¥μ„±μ΄ λ†’λ‹¤.
>
> λ”°λΌμ„ `stdlib`μ„ κ³µλ¶€ν•΄ λ‘λ©΄ μΆ‹λ‹¤.
>
> stdlibμ— μ—†λ” μΌλ°μ μΈ μ•κ³ λ¦¬μ¦μ΄ ν•„μ”ν•κ±°λ‚, νΉμ • μ•κ³ λ¦¬μ¦μ„ λ°λ³µν•΄μ„ μ‚¬μ©ν•΄μ•Ό ν•λ” κ²½μ° ν”„λ΅μ νΈ λ‚΄λ¶€μ— μ§μ ‘ μ •μνμ.
>
> μΌλ°μ μΌλ΅ μ΄λ° μ•κ³ λ¦¬μ¦λ“¤μ€ `ν™•μ¥ ν•¨μ`λ΅ μ •μν•μ.

## Item 21. μΌλ°μ μΈ ν”„λ΅νΌν‹° ν¨ν„΄μ€ ν”„λ΅νΌν‹° μ„μ„μΌλ΅ λ§λ“¤μ–΄λΌ

μ½”ν‹€λ¦°μ€ μ½”λ“ μ¬μ‚¬μ©κ³Ό κ΄€λ ¨ν•΄μ„ ν”„λ΅νΌν‹° μ„μ„μ΄λΌλ” μƒλ΅μ΄ κΈ°λ¥μ„ μ κ³µ
- μΌλ°μ μΈ ν”„λ΅νΌν‹°μ ν–‰μ„λ¥Ό μ¶”μ¶ν•΄μ„ μ¬μ‚¬μ© κ°€λ¥

λ€ν‘μ μΈ μλ΅ μ§€μ—° ν”„λ΅νΌν‹°
- μ½”ν‹€λ¦°μ—μ„λ” stdlib `lazy` ν”„λ΅νΌν‹° ν¨ν„΄μΌλ΅ μ‰½κ² κµ¬ν„

```kotlin
val value by lazy { createValue() }
```

.

ν”„λ΅νΌν‹° μ„μ„μ„ μ‚¬μ©ν•λ©΄, μ΄μ™Έμ—λ„ λ³€ν™”κ°€ μμ„ λ• μ΄λ¥Ό κ°μ§€ν•λ” `observable` ν¨ν„΄μ„ μ‰½κ² μƒμ„± κ°€λ¥

```kotlin
var items: List<Item> by
    Delegates.observable(listOf()) { -, -, - ->
        notifyDataSetChanged()
    }
```

.

ν”„λ΅νΌν‹° μ„μ„μ€ λ‹¤λ¥Έ κ°μ²΄μ λ©”μ„λ“λ¥Ό ν™μ©ν•΄μ„ ν”„λ΅νΌν‹°μ μ ‘κ·Όμ(Getter, Setter)λ¥Ό λ§λ“λ” λ°©μ‹
- Getter β” getValue, Setter β” setValue ν•¨μλ¥Ό μ‚¬μ©ν•΄μ„ μƒμ„±

```kotlin
var token: String? by LoggingProperty(null)
var attempt: Int by LoggingProperty(0)

private class LoggingProperty<T>(var value: T) {
    operator fun getValue(
        thisRef: Any?,
        prop: KProperty<*>
    ): T {
        println("${prop.name} returned value $value")
        return value
    }

    operator fun setValue(
        thisRef: Any?,
        prop: KProperty<*>,
        newValue: T
    ) {
        val name = prop.name
        println("$name changed form $value to $newValue")
        value = newValue
    }
}

@Test
fun loggingProperty() {
    token = "abe" // token changed form null to abe
    attempt = 10 // attempt changed form 0 to 10
}
```

.

μ½”ν‹€λ¦° stdlibμ—μ„ μ•μ•„λ‘λ©΄ μΆ‹μ€ ν”„λ΅νΌν‹° λΈλ¦¬κ²μ΄ν„°
- lazy
- Delegates.observable
- Delegates.vetoable
- Delegates.notNull

π“– **μ •λ¦¬**

> ν”„λ΅νΌν‹° μ„μ„μ€ ν”„λ΅νΌν‹° ν¨ν„΄μ„ μ¶”μ¶ν•λ” μΌλ°μ μΈ λ°©λ²•μ΄λΌ λ§μ΄ μ‚¬μ©
>
> μ½”ν‹€λ¦° κ°λ°μλΌλ©΄ ν”„λ΅νΌν‹° μ„μ„μ΄λΌλ” κ°•λ ¥ν• λ„κµ¬μ™€ κ΄€λ ¨λ λ‚΄μ©μ„ μ μ•μ•„μ•Ό ν•¨
>
> μΌλ°μ μΈ ν¨ν„΄μ„ μ¶”μ¶ν•κ±°λ‚ λ” μΆ‹μ€ API μƒμ„±μ— ν™μ© κ°€λ¥

## Item 22. μΌλ°μ μΈ μ•κ³ λ¦¬μ¦μ„ κµ¬ν„ν•  λ• μ λ„¤λ¦­μ„ μ‚¬μ©ν•λΌ

> νƒ€μ… μ•„κ·λ¨ΌνΈ(νƒ€μ… νλΌλ―Έν„°)λ¥Ό μ‚¬μ©ν•λ” ν•¨μλ¥Ό `μ λ„¤λ¦­ ν•¨μ`λΌκ³  λ¶€λ¥Έλ‹¤.

νƒ€μ… νλΌλ―Έν„°λ” μ»΄νμΌλ¬μ— νƒ€μ…κ³Ό κ΄€λ ¨λ μ •λ³΄λ¥Ό μ κ³µν•μ—¬ μ»΄νμΌλ¬κ°€ νƒ€μ…μ„ μ΅°κΈμ΄λΌλ„ λ” μ •ν™•ν•κ² μ¶”μΈ΅ν•  μ μλ„λ΅ μ§€μ›

```kotlin
public inline fun <T> Iterable<T>.filter(
    predicate: (T) -> Boolean
): List<T> {
    return filterTo(ArrayList<T>(), predicate)
}

public inline fun <T, C : MutableCollection<in T>> Iterable<T>.filterTo(
    destination: C, 
    predicate: (T) -> Boolean
): C {
    for (element in this) if (predicate(element)) destination.add(element)
    return destination
}
```

.

π‘‰π» **μ λ„¤λ¦­ μ ν•**

νƒ€μ… νλΌλ―Έν„°μ μ¤‘μ”ν• κΈ°λ¥ μ¤‘ ν•λ‚λ” κµ¬μ²΄μ μΈ νƒ€μ…μ μ„λΈνƒ€μ…λ§ μ‚¬μ©ν•κ² νƒ€μ…μ„ μ ν•ν•λ” κ²ƒ
- νƒ€μ… μ ν•μ΄ κ±Έλ¦¬λ―€λ΅ λ‚΄λ¶€μ—μ„ ν•΄λ‹Ή νƒ€μ…μ΄ μ κ³µν•λ” λ©”μ„λ“λ¥Ό μ‚¬μ©ν•  μ μλ‹¤.

```kotlin
fun <T : Comparable<T>> Iterable<T>.sorted(): List<T> {
    //
}

fun <T, C : MutableCollection<in T>>
Iterable<T>.toCollection(destination: C): C {
    //
}

class ListAdapter<T: ItemAdapter>( /* ... */ ) {
    //
}
```

λ§μ΄ μ‚¬μ©ν•λ” μ ν•μΌλ΅λ” `Any`κ°€ μλ”λ°, `nullable`μ΄ μ•„λ‹ νƒ€μ…μ„ λ‚νƒ€λ‚Έλ‹¤.

```kotlin
public inline fun <T, R : Any> Iterable<T>.mapNotNull(
    transform: (T) -> R?
): List<R> {
    return mapNotNullTo(ArrayList<R>(), transform)
}
```

π“– **μ •λ¦¬**

> μ½”ν‹€λ¦° μλ£ν• μ‹μ¤ν…μ—μ„ νƒ€μ… νλΌλ―Έν„°λ” κµ‰μ¥ν μ¤‘μ”ν• λ¶€λ¶„
>
> μΌλ°μ μΌλ΅ μ΄λ¥Ό μ‚¬μ©ν•΄μ„ type-safe μ λ„¤λ¦­ μ•κ³ λ¦¬μ¦κ³Ό μ λ„¤λ¦­ κ°μ²΄λ¥Ό κµ¬ν„
>
> νƒ€μ… νλΌλ―Έν„°λ” κµ¬μ²΄ μλ£ν•μ μ„λΈνƒ€μ…μ„ μ ν• κ°€λ¥
>
> μ΄λ ‡κ² ν•λ©΄ νΉμ • μλ£ν•μ΄ μ κ³µν•λ” λ©”μ„λ“λ¥Ό μ•μ „ν•κ² μ‚¬μ© κ°€λ¥

## Item 23. νƒ€μ… νλΌλ―Έν„°μ μ„€λ„μ‰μ„ ν”Όν•λΌ

ν”„λ΅νΌν‹°μ™€ νλΌλ―Έν„°κ°€ κ°™μ€ μ΄λ¦„μ„ κ°€μ§ μ μλ‹¤.
- μ΄λ ‡κ² λλ©΄ μ§€μ—­ νλΌλ―Έν„°κ°€ μ™Έλ¶€ μ¤μ½”ν”„μ— μλ” ν”„λ΅νΌν‹°λ¥Ό κ°€λ¦°λ‹¤.
- μ΄λ¥Ό `μ„€λ„μ‰`μ΄λΌκ³  λ¶€λ¥Έλ‹¤.

```kotlin
class Forest(val name: String) {
    
    fun addTree(name: String) {
        //...
    }
}
```

μ΄ κ²½μ°, addTree ν•¨μκ°€ ν΄λμ¤ νƒ€μ… νλΌλ―Έν„°μΈ Tλ¥Ό μ‚¬μ©ν•λ” κ²ƒμ΄ μΆ‹λ‹¤.

```kotlin
class Forest(T: Tree) {
    
    fun addTree(tree: T) {
        //...
    }
}

val forest = Forest<Birch>()
forest.addTree(Birch())
forest.addTree(Spruce()) // type mismatch ERROR
```
π“– **μ •λ¦¬**

> νƒ€μ… νλΌλ―Έν„° μ„€λ„μ‰μ΄ λ°μƒν• μ½”λ“λ” μ΄ν•΄ν•κΈ° μ–΄λ ¤μΈ μ μλ‹¤.
>
> νƒ€μ… νλΌλ―Έν„°κ°€ μ„€λ„μ‰λλ” κ²½μ° μ½”λ“λ¥Ό μ£Όμν•΄μ„ μ‚΄ν΄λ³΄μ.

## Item 24. μ λ„¤λ¦­ νƒ€μ…κ³Ό variance ν•μ •μλ¥Ό ν™μ©ν•λΌ

`invariant`λ” μ λ„¤λ¦­ νƒ€μ…μΌλ΅ λ§λ“¤μ–΄μ§€λ” νƒ€μ…λ“¤μ΄ μ„λ΅ κ΄€λ ¨μ„±μ΄ μ—†λ‹¤λ” μλ―Έ
- λ§μΌ μ–΄λ–¤ κ΄€λ ¨μ„±μ„ μ›ν•λ‹¤λ©΄, `out` λλ” `in` μ΄λΌλ” variance ν•μ •μλ¥Ό λ¶™μΈλ‹¤.

`out`μ€ νƒ€μ… νλΌλ―Έν„°λ¥Ό `covariant`(κ³µλ³€μ„±)μΌλ΅ λ§λ“ λ‹¤.
- ex. Aκ°€ Bμ μ„λΈ νƒ€μ…μΌ λ•, Cup\<A\>κ°€ Cup\<B\>μ μ„λΈνƒ€μ…

`in` ν•μ •μλ” νƒ€μ… νλΌλ―Έν„°λ¥Ό `contravariant`(λ°λ³€μ„±)μΌλ΅ λ§λ“ λ‹¤.
- ex. Aκ°€ Bμ μ„λΈ νƒ€μ…μΌ λ•, Cup\<A\>κ°€ Cup\<B\>μ μνΌνƒ€μ…

![Result](https://github.com/jihunparkme/jihunparkme.gitbook.io/blob/main/.gitbook/assets/kotlin/variance.png?raw=trueΒ 'Result')

π“– **μ •λ¦¬**

μ½”ν‹€λ¦°μ€ νƒ€μ… μ•„κ·λ¨ΌνΈμ κ΄€κ³„μ— μ μ•½μ„ κ±Έ μ μλ” κ°•λ ¥ν• μ λ„¤λ¦­ κΈ°λ¥μ„ μ κ³µ

> μ½”ν‹€λ¦°μ—μ„ μ κ³µν•λ” νƒ€μ… ν•μ •μ
>
> - νƒ€μ… νλΌλ―Έν„°μ κΈ°λ³Έμ μΈ `variance` λ™μ‘μ€ `invariant`
>   - λ§μΌ Cup\<T\>λΌλ©΄, νƒ€μ… νλΌλ―Έν„° Tλ” invariant
>   - Aκ°€ Bμ μ„λΈνƒ€μ…μ΄λΌκ³  ν•  λ• Cup\<A\>μ™€ Cup\<B\>λ” μ•„λ¬΄ κ΄€κ³„λ¥Ό κ°–μ§€ μ•μ
> - `out` ν•μ •μλ” νƒ€μ… νλΌλ―Έν„°λ¥Ό `covariant`ν•κ² λ§λ“¦
>   - λ§μΌ Cup\<T\>λΌλ©΄, νƒ€μ… νλΌλ―Έν„° Tλ” covariant
>   - Aκ°€ Bμ μ„λΈνƒ€μ…μ΄λΌκ³  ν•  λ• Cup\<A\>λ” Cup\<B\>μ μ„λΈνƒ€μ…
>   - covariant νƒ€μ…μ€ out μ„μΉμ— μ‚¬μ© κ°€λ¥
> - `in` ν•μ •μλ”  νƒ€μ… νλΌλ―Έν„°λ¥Ό `contravariant`ν•κ² λ§λ“¦
>   - λ§μΌ Cup\<T\>λΌλ©΄, νƒ€μ… νλΌλ―Έν„° Tλ” contravariant
>   - Aκ°€ Bμ μ„λΈνƒ€μ…μ΄λΌκ³  ν•  λ• Cup\<B\>λ” Cup\<A\>μ μνΌνƒ€μ…
>   - contravariant νƒ€μ…μ€ in μ„μΉμ— μ‚¬μ© κ°€λ¥
>
> μ½”ν‹€λ¦°μ—μ„λ”
>
> - List, Set νƒ€μ… νλΌλ―Έν„°λ” `covariant`(out ν•μ •μ)
>   - Map κ°’ νƒ€μ…μ„ λ‚νƒ€λ‚΄λ” νƒ€μ… νλΌλ―Έν„°λ„ covariant(out ν•μ •μ)
>   - λ‹¨, Mutable.. νƒ€μ… νλΌλ―Έν„°λ” `invariant`
> - ν•¨μ νƒ€μ…μ νλΌλ―Έν„° νƒ€μ…μ€ `contravariant`(in ν•μ •μ)
>   - λ¦¬ν„΄ νƒ€μ…μ€ `contravariant`(out ν•μ •μ)
> - λ¦¬ν„΄λ§ λλ” νƒ€μ…μ—λ” `covariant`(out ν•μ •μ) μ‚¬μ©
> - ν—μ©λ§ λλ” νƒ€μ…μ—λ” `contravariant`(in ν•μ •μ) μ‚¬μ©

## Item 25. κ³µν†µ λ¨λ“μ„ μ¶”μ¶ν•΄μ„ μ—¬λ¬ ν”λ«νΌμ—μ„ μ¬μ‚¬μ©ν•λΌ

κ³µν†µ λ¨λ“μ„ μ‚¬μ©ν•λ©΄ μ—¬λ¬ ν”λ«νΌμ—μ„ μ½”λ“λ¥Ό μ¬μ‚¬μ©ν•  μ μλ‹¤.
- λ”°λΌμ„ μ΄λ¬ν• μ ‘κ·Ό λ°©λ²•μ€ μ½”λ“λ¥Ό ν• λ²λ§ μ‘μ„±ν•΄μ„ κ³µν†µ λ…Όλ¦¬ λλ” κ³µν†µ μ•κ³ λ¦¬μ¦μ„ μ¬μ‚¬μ©ν•  μ μκ² ν•΄μ£Όλ” κ°•λ ¥ν• λ„κµ¬


















232